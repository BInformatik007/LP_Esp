<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/header&footer.css">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="icon" href="../media/imgs_Login/logo-pesta√±a.png" type="image/png">
    <title>Espa√±olYa</title>
</head>
<body>

<!-- -------------------- HEADER SECTION -------------------- -->
<section class="sections-group header-section">
    <header class="header">
        <input type="checkbox" class="header__menu-checkbox" id="open-menu">
        <label for="open-menu" class="header__menu-icon" role="button">‚ò∞</label>
        <div class="header__logo-container">
            <a href="../html/index.html"><img src="../media/imgs_Login/icono.png" alt="Logo" class="header__logo"></a>
        </div>
        <nav class="header__nav">
            <ul class="header__ul">
                <li class="header__li"><a href="../html/index.html" class="header__link">Inicio</a></li>
                <li class="header__li"><a href="../html/lessons.html" class="header__link">Lecciones</a></li>
                <li class="header__li"><a href="../html/challenge.html" class="header__link">Desaf√≠os</a></li>
                <li class="header__li"><a href="../html/profile.html" class="header__link">Perfil</a></li>
            </ul>
        </nav>
        <div class="header__account-btn">
            <a href="../html/login.html" class="header__account-link header__account-link-login">Iniciar sesi√≥n</a>
            <a href="../html/login.html" class="header__account-link header__account-link-singup">Registrarse</a>
        </div>
    </header>
</section>

<!-- -------------------- LAYOUT SECTION -------------------- -->
<section class="sections-group layout-section">
    <div class="layout__content-container">
        <div class="layout__bt">
            <h2 class="layout__title">Aprende Espa√±ol de forma <span class="green-text">Divertida</span></h2>
        </div>
        <div class="layout__st">
            <p class="layout__text">Domina el Espa√±ol con lecciones interactivas, desaf√≠os emocionantes y un sistema de aprendizaje personalizado.</p>
        </div>
        <div class="layout__btn">
            <a href="../html/lessons.html" class="layout__btn-link">¬°Comienza Ya!</a>
        </div>
    </div>
</section>

<!-- -------------------- MAIN SECTION -------------------- -->
<section class="sections-group main-section">
    <div class="main__module-container">
        <div class="main__module-title-container">
            <h2 class="main__module-title">Tus m√≥dulos de aprendizaje</h2>
        </div>
        <div class="main__module-cards-container">
            <div class="main__module-cards">
                <div class="main__module-cards-icons-container"><span class="main__module-cards-icons">üìö</span></div>
                <div class="main__module-cards-content">
                    <h3 class="main__module-cards-title">Gram√°tica b√°sica</h3>
                    <p class="main__module-cards-description">Aprende las estructuras fundamentales del espa√±ol.</p>
                    <div class="main__module-cards-progress-container">
                        <div class="main__module-cards-progress-bar" style="width: 65%;"></div>
                    </div>
                </div>
            </div>

            <div class="main__module-cards">
                <div class="main__module-cards-icons-container"><span class="main__module-cards-icons">üìù</span></div>
                <div class="main__module-cards-content">
                    <h3 class="main__module-cards-title">Vocabulario Esencial</h3>
                    <p class="main__module-cards-description">Palabras y frases m√°s comunes.</p>
                    <div class="main__module-cards-progress-container">
                        <div class="main__module-cards-progress-bar" style="width: 40%;"></div>
                    </div>
                </div>
            </div>

            <div class="main__module-cards">
                <div class="main__module-cards-icons-container"><span class="main__module-cards-icons">üó£</span></div>
                <div class="main__module-cards-content">
                    <h3 class="main__module-cards-title">Pronunciaci√≥n</h3>
                    <p class="main__module-cards-description">Mejora tu acento y fluidez.</p>
                    <div class="main__module-cards-progress-container">
                        <div class="main__module-cards-progress-bar" style="width: 85%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- -------------------- MESSENGER SYSTEM -------------------- -->
<div id="chat-launcher" style="position: fixed; bottom: 20px; right: 20px; z-index: 9998;">
    <button id="toggle-user-list" aria-label="Abrir lista de usuarios" style="width: 50px; height: 50px; background-color: #1976d2; color: white; font-size: 24px; border-radius: 50%; cursor: pointer; border: none;">üí¨</button>
</div>

<div id="user-list-panel" class="hidden chat-panel">
    <label for="user-list" class="chat-label">Elige un usuario:</label>
    <select id="user-list" class="chat-select">
        <option value="">Selecciona un usuario</option>
    </select>
</div>

<div class="messenger hidden" id="messenger-widget">
    <div class="messenger-header">
        <span id="messenger-recipient">Chat</span>
        <button onclick="toggleMessenger()" aria-label="Cerrar chat" style="background:none;border:none;color:white;font-size:18px;cursor:pointer">&times;</button>
    </div>
    <div id="messenger-messages" class="messenger-body" aria-live="polite"></div>
    <div class="messenger-footer">
        <input id="messenger-input" type="text" placeholder="Escribe un mensaje..." autocomplete="off" aria-label="Escribir mensaje">
        <button onclick="sendMessage()" aria-label="Enviar mensaje">Enviar</button>
    </div>
</div>

<style>
    .messenger { position: fixed; bottom: 0; right: 20px; width: 320px; background-color: white; border: 1px solid #ccc; border-radius: 10px 10px 0 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.2); display: flex; flex-direction: column; z-index: 9999; animation: fadeInUp 0.3s ease; }
    .messenger-header { padding: 10px; background-color: #1976d2; color: white; display: flex; justify-content: space-between; align-items: center; font-weight: bold; }
    .messenger-body { height: 250px; overflow-y: auto; padding: 10px; background: #f9f9f9; display: flex; flex-direction: column; }
    .messenger-footer { display: flex; border-top: 1px solid #ddd; }
    .messenger-footer input { flex: 1; border: none; padding: 10px; font-size: 14px; }
    .messenger-footer button { border: none; padding: 10px; background: #1976d2; color: white; font-weight: bold; cursor: pointer; }
    .msg { margin-bottom: 10px; padding: 8px; border-radius: 6px; max-width: 80%; word-wrap: break-word; }
    .msg.sent { background: #d0e8ff; align-self: flex-end; }
    .msg.received { background: #f1f1f1; align-self: flex-start; }
    .hidden { display: none !important; }
    .chat-panel { position: fixed; bottom: 80px; right: 20px; background-color: white; border: 1px solid #ccc; border-radius: 10px; padding: 10px; z-index: 9999; width: 250px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); animation: fadeIn 0.2s ease-in-out; }
    .chat-label { font-weight: bold; display: block; margin-bottom: 5px; }
    .chat-select { width: 100%; padding: 8px; font-size: 14px; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
</style>

<script type="module">
    import { toggleMessenger, sendMessage, openChatWith, loadUserList, startChatWithSelectedUser } from '/LP_Esp/js/messenger.js';
    window.toggleMessenger = toggleMessenger;
    window.sendMessage = sendMessage;
    window.openChatWith = openChatWith;
    window.startChatWithSelectedUser = startChatWithSelectedUser;

    document.getElementById('toggle-user-list').addEventListener('click', () => {
        document.getElementById('user-list-panel').classList.toggle('hidden');
    });

    document.getElementById('user-list').addEventListener('change', startChatWithSelectedUser);
    loadUserList();
</script>

<!-- -------------------- SCRIPTS ORIGINALES -------------------- -->
<script src="../js/load-footer.js"></script>
<script type="module" src="../js/index.js"></script>
<script type="module" src="../js/messenger.js"></script>
</body>
</html>
